{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Profile - Online Tourist Guide</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Bootstrap & Font Awesome -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css">

  <style>
    body {
      background-color: #f0f4f7;
      font-family: 'Montserrat', sans-serif;
    }
    /* Container & Card */
    .profile-container {
      margin-top: 60px;
      margin-bottom: 60px;
    }
    .profile-card {
      background-color: #fff;
      border-radius: 10px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    /* Profile Left Panel */
    .profile-left {
      background-color: #e9ecef;
      text-align: center;
      padding: 30px;
    }
    .profile-left img {
      width: 150px;
      height: 150px;
      border-radius: 50%;
      object-fit: cover;
      border: 5px solid #fff;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    /* Profile Right Panel */
    .profile-center {
      padding: 0 20px 20px 20px;
    }
    .profile-header {
      padding: 20px;
      border-bottom: 1px solid #e9ecef;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .profile-header h4 {
      margin: 0;
      font-weight: 700;
    }
    /* Buttons */
    .btn-back, .btn-edit, .btn-save {
      background: linear-gradient(90deg, #27ae60, #3a539b);
      border: none;
      border-radius: 30px;
      padding: 10px 20px;
      color: #fff;
      font-weight: 600;
      transition: transform 0.3s, opacity 0.3s;
    }
    .btn-back:hover, .btn-edit:hover, .btn-save:hover {
      transform: translateY(-2px);
      opacity: 0.9;
    }
    /* Info Display (View Mode) */
    .info-group {
      padding: 15px;
      border-bottom: 1px solid #e9ecef;
    }
    .info-group:last-child {
      border-bottom: none;
    }
    .info-group label {
      font-weight: 600;
      display: block;
      color: #555;
    }
    .info-group p {
      margin: 0;
      color: #777;
    }
    /* Global Form Field Styling */
    /* This applies to any <input>, <select>, <textarea> inside the modal-body */
    .modal-body input[type=text],
    .modal-body input[type=password],
    .modal-body input[type=email],
    .modal-body input[type=number],
    .modal-body textarea,
    .modal-body select {
      display: block;
      width: 100%;
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 10px;
      font-size: 14px;
      margin-top: 5px;
      margin-bottom: 5px;
      transition: border-color 0.3s, box-shadow 0.3s;
    }
    .modal-body input:focus,
    .modal-body textarea:focus,
    .modal-body select:focus {
      border-color: #3a539b;
      box-shadow: 0 0 5px rgba(58,83,155,0.3);
      outline: none;
    }
    @media (max-width: 768px) {
      .profile-left, .profile-center {
        text-align: center;
      }
      .profile-header {
        flex-direction: column;
      }
      .btn-edit {
        margin-top: 10px;
      }
    }
  </style>
</head>
<body>
<div class="container profile-container">
  <div class="card profile-card">
    <div class="row g-0">
      <!-- Left Section: Profile Picture -->
      <div class="col-md-3 profile-left">
        {% if user.profile_picture %}
          <img src="{{ user.profile_picture.url }}" alt="Profile Picture">
        {% else %}
          <img src="{% static 'img/default_avatar.png' %}" alt="Default Avatar">
        {% endif %}
        <h4 class="mt-3">{{ user.username }}</h4>
        <p>{{ user.email }}</p>
      </div>
      <!-- Right Section: Profile Details -->
      <div class="col-md-9 profile-center">
        <div class="profile-header">
          <!-- Back Button -->
          <a href="javascript:history.back()" class="btn-back">
            <i class="fas fa-arrow-left"></i> Back
          </a>
          <h4 id="profile-title">My Profile</h4>
          <!-- Edit Button: Opens the modal -->
          <button class="btn-edit" data-bs-toggle="modal" data-bs-target="#editModal">
            <i class="fas fa-user-edit me-1"></i> Edit
          </button>
        </div>
        <!-- View Mode -->
        <div id="view-mode">
          <div class="info-group">
            <label>Username</label>
            <p>{{ user.username }}</p>
          </div>
          <div class="info-group">
            <label>Email</label>
            <p>{{ user.email }}</p>
          </div>
          <div class="info-group">
            <label>Mobile Number</label>
            <p>{{ user.mobile_number }}</p>
          </div>
          <div class="info-group">
            <label>Nationality</label>
            <p>{{ user.nationality }}</p>
          </div>
          <div class="info-group">
            <label>City</label>
            <p>{{ user.city }}</p>
          </div>
          <div class="info-group">
            <label>Postal Address</label>
            <p>{{ user.postal_address }}</p>
          </div>
          <div class="info-group">
            <label>Preferred Season</label>
            <p>{{ user.preferred_season }}</p>
          </div>
          <div class="info-group">
            <label>Preferred Travel Type</label>
            <p>{{ user.preferred_travel_type }}</p>
          </div>
          <div class="info-group">
            <label>Age Range</label>
            <p>{{ user.age_range }}</p>
          </div>
          <div class="info-group">
            <label>Budget Range</label>
            <p>{{ user.budget_range }}</p>
          </div>
        </div>
      </div> <!-- End Right Section -->
    </div>
  </div>
</div>

<!-- Modal for Edit Profile -->
<div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <form id="updateProfileForm" method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="modal-header">
          <h5 class="modal-title" id="editModalLabel">Edit Profile</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        
        <div class="modal-body">
          <div class="container-fluid">
            <!-- Row 1 -->
            <div class="row">
              <div class="col-md-6 mb-3">
                <label>Username</label>
                {{ form.username }}
              </div>
              <div class="col-md-6 mb-3">
                <label>Email</label>
                {{ form.email }}
              </div>
            </div>
            <!-- Row 2 -->
            <div class="row">
              <div class="col-md-6 mb-3">
                <label>Mobile Number</label>
                {{ form.mobile_number }}
              </div>
              <div class="col-md-6 mb-3">
                <label>Nationality</label>
                {{ form.nationality }}
              </div>
            </div>
            <!-- Row 3 -->
            <div class="row">
              <div class="col-md-6 mb-3">
                <label>City</label>
                {{ form.city }}
              </div>
              <div class="col-md-6 mb-3">
                <label>Postal Address</label>
                {{ form.postal_address }}
              </div>
            </div>
            <!-- Row 4 -->
            <div class="row">
              <div class="col-md-6 mb-3">
                <label>Preferred Season</label>
                <select class="form-select" name="preferred_season">
                  <option value="Summer">Summer</option>
                  <option value="Winter">Winter</option>
                  <option value="Spring">Spring</option>
                  <option value="Autumn">Autumn</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label>Preferred Travel Type</label>
                <select class="form-select" name="preferred_travel_type">
                  <option value="Adventure">Adventure</option>
                  <option value="Leisure">Leisure</option>
                  <option value="Cultural">Cultural</option>
                  <option value="Business">Business</option>
                </select>
              </div>
            </div>
            <!-- Row 5 -->
            <div class="row">
              <div class="col-md-6 mb-3">
                <label>Age Range</label>
                {{ form.age_range }}
              </div>
              <div class="col-md-6 mb-3">
                <label>Budget Range</label>
                {{ form.budget_range }}
              </div>
            </div>
            <!-- Row 6 -->
            <div class="row">
              <div class="col-md-12 mb-3">
                <label>Profile Picture</label>
                {{ form.profile_picture }}
              </div>
            </div>
          </div>
        </div>
        
        <div class="modal-footer">
          <!-- Close (Back) button -->
          <button type="button" class="btn-back" data-bs-dismiss="modal">Back</button>
          <!-- Save button -->
          <button type="submit" class="btn-save">Save</button>
        </div>
      </form>
    </div>
  </div>
</div>


<!-- Bootstrap Bundle with Popper (Required for Modal) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
